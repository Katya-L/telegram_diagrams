sequenceDiagram

    actor U as Authorized user
    participant C as Client
    participant S as Server

    U ->> C: 1. Нажатие на личный чат 

    alt Есть интернет-соединение

        C ->> S: 2. Запрос чата пользователя по id
        S ->> S: 3. Получение данных из БД
        S -->> C: 4. Передача данных чата
        C ->> C: 5. Формирование вывода 
        C ->> C: 6. Отображение чата
        C ->> C: 7. Обновление локальной БД

        U ->> C: 8. Отправка сообщения
        C ->> S: 9. Запрос на отправку сообщения в чате id
        S ->> S: 10. Сохранение данных в БД
        S ->> S: 11. Отправка сообщения собеседнику
        S -->> C: 12. Передача данных чата
        C ->> C: 13. Формирование вывода 
        C ->> C: 14. Отображение чата
        C ->> C: 15. Обновление локальной БД 

    else Нет интернет-соединения
    
        loop Пока не появится интернет
            C ->> C: 2a. Отображение загрузки
        end
        
        C ->> C: 3a. Получение данных из локальной БД
        C ->> C: 4a. Формирование вывода 
        C ->> C: 5a. Отображение чата 

        U ->> C: 6a. Отправка сообщения
        C ->> C: 7a. Сохранение данных в локальную БД
        C ->> C: 8a. Получение данных из локальной БД
        C ->> C: 9a. Формирование вывода 
        C ->> C: 10a. Отображение чата 
        
        loop Пока не появится интернет
            C ->> C: 11a. Отображение загрузки на сообщении
        end

        Note over C: Данные из локальной БД будут синхронизированы с удаленной после появления интернета
    end

